<!doctype html><html lang=en><head><title>Hazelcast on Karaf · Ioannis Canellos - My Blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Ioannis Canellos"><meta name=description content="Prologue Link to heading The last months Hazelcast caught my attention. I first saw the JIRA of the camel-hazelcast component, then I read about it, I run some examples and eventually I fell in love with it.
If you are not already familiar with it, Hazelcast is an opensource clustering platform, which provdies a lot of features such as:
Auto discovery Distributed Collection Transactions Data Partitioning You can visit the Hazelcast Documentation for more information."><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Hazelcast on Karaf"><meta name=twitter:description content="Prologue Link to heading The last months Hazelcast caught my attention. I first saw the JIRA of the camel-hazelcast component, then I read about it, I run some examples and eventually I fell in love with it.
If you are not already familiar with it, Hazelcast is an opensource clustering platform, which provdies a lot of features such as:
Auto discovery Distributed Collection Transactions Data Partitioning You can visit the Hazelcast Documentation for more information."><meta property="og:title" content="Hazelcast on Karaf"><meta property="og:description" content="Prologue Link to heading The last months Hazelcast caught my attention. I first saw the JIRA of the camel-hazelcast component, then I read about it, I run some examples and eventually I fell in love with it.
If you are not already familiar with it, Hazelcast is an opensource clustering platform, which provdies a lot of features such as:
Auto discovery Distributed Collection Transactions Data Partitioning You can visit the Hazelcast Documentation for more information."><meta property="og:type" content="article"><meta property="og:url" content="https://iocanel.github.io/2011/02/hazelcast-on-karaf/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2011-02-28T00:00:00+02:00"><meta property="article:modified_time" content="2011-02-28T00:00:00+02:00"><link rel=canonical href=https://iocanel.github.io/2011/02/hazelcast-on-karaf/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.c4d7e93a158eda5a65b3df343745d2092a0a1e2170feeec909b8a89443903c6a.css integrity="sha256-xNfpOhWO2lpls980N0XSCSoKHiFw/u7JCbiolEOQPGo=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.78b5fe3864945faf5207fb8fe3ab2320d49c3365def0e88ac1df0ddadc54a03c.css integrity="sha256-eLX+OGSUX69SB/uP46sjINScM2Xe8OiKwd8N2txUoDw=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5><meta name=generator content="Hugo 0.105.0"></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Ioannis Canellos - My Blog</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>blog</a></li><li class=navigation-item><a class=navigation-link href=/about/>about</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://iocanel.github.io/2011/02/hazelcast-on-karaf/>Hazelcast on Karaf</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2011-02-28T00:00:00+02:00>February 28, 2011</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
4-minute read</span></div></div></header><div><h2 id=prologue>Prologue
<a class=heading-link href=#prologue><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>The last months <a href=https://hazelcast.com>Hazelcast</a> caught my attention. I first saw the JIRA of the <a href=http://camel.apache.org/hazelcast-component.html>camel-hazelcast</a> component, then I read about it, I run some examples and eventually I fell in love with it.</p><p>If you are not already familiar with it, <a href=https://hazelcast.com>Hazelcast</a> is an opensource clustering platform, which provdies a lot of features such as:</p><ul><li>Auto discovery</li><li>Distributed Collection</li><li>Transactions</li><li>Data Partitioning</li></ul><p>You can visit the <a href=https://hazelcast.com>Hazelcast</a> Documentation for more information.
In this blog post I will show how to run hazelcast on <a href=http://karaf.apache.org>Apache Karaf</a> or <a href=http://servicemix.apache.org>Apache ServiceMix</a> and I will provide an example application that creates a hazelcast instance, deploys the hazelcast monitoring web application and adds a couple of shell commands on <a href=http://karaf.apache.org>Apache Karaf</a>.</p><p>Finally, I will create a <a href=https://hazelcast.com>Hazelcast</a> Topic using blueprint and we will create a clustered echo command using that topic.</p><p>For all of the above I will provide the full source so that you can try it yourself.</p><h2 id=hazelcast-and-osgi><a href=https://hazelcast.com>Hazelcast</a> & OSGi
<a class=heading-link href=#hazelcast-and-osgi><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>According to the hazelcast website hazelcast is not yet OSGi ready (it is still in the TODO list). However, I found that versions 1.9.x are ready enough to get you going. In this post I will use the current trunk of hazelcast source (1.9.3-SNAPSHOT) for which I have created a couple of patches for the web-console and for some other minor issues.</p><p><a href=https://hazelcast.com>Hazelcast</a> Instance as an OSGi service
Even though that <a href=https://hazelcast.com>Hazelcast</a> requires zero configuration, I found it best to create a <a href=https://hazelcast.com>Hazelcast</a> instance using Spring, pass the desired configuration and finally expose the instance as an OSGi service.
In the snippet above I am using a minimal configuration which only set the credentials of the <a href=https://hazelcast.com>Hazelcast</a>. <a href=https://hazelcast.com>Hazelcast</a> has no dependencies so the only thing required is the hazelcast bundle and the hazelcast monitoring war (if you wish to have access to the web console). From the Karaf shell you can just type:</p><p>Once the hazelcast and its monitoring are started, you can browse the hazelcast monitoring at <a href=http://localhost:8181/hazelcast-monitor>http://localhost:8181/hazelcast-monitor</a>. Which looks like the page below.</p><figure><img src=images/hazelcast-console.png alt="Figure 1: Hazelcast console"><figcaption><p>Figure 1: <a href=https://hazelcast.com>Hazelcast</a> console</p></figcaption></figure><h2 id=building-a-distributed-collection-using-the-blueprint>Building a distributed collection using the Blueprint
<a class=heading-link href=#building-a-distributed-collection-using-the-blueprint><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>To create a distributed collection with hazelcast all you need is an instance and a unique String identifier that will be used to uniquely identify the collection. Since we already have created an instance and exposed it as an OSGi service the rest are pretty easy:</p><p>We will use this distributed topic to build a distributed echo command (A command that will print messages in the console of all nodes). Now we need two simple things:</p><p>A listener on that topic that will listen for messages and display them
A shell command that will put messages to the topic.
A listener could be as simple as this:
This is a simple pojo that contains a topic and acts as MessageListner on that topic. For each message added to the topic this listener displays it to the standard output. We could add this pojo to our blueprint xml</p><p>What’s left to be done is to create the command that will actually display the message that is added to the topic.</p><h2 id=putting-it-them-all-together>Putting it them all together
<a class=heading-link href=#putting-it-them-all-together><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>We can now start two karaf nodes either on the same machine or on separate machines in the same network, deploy hazelcast and its monitoring and finally deploy the instance, the topic and the commands as we did so far.</p><p>Let’s try the command:</p><figure><img src=images/inter-karaf-messaging.png alt="Figure 2: Messaging between different karaf installations"><figcaption><p>Figure 2: Messaging between different karaf installations</p></figcaption></figure><h2 id=using-the-full-source>Using the full source
<a class=heading-link href=#using-the-full-source><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>The code can be found on github at: <a href=https://github.com/iocanel/blog/tree/hazelcast-on-karaf/sources>hazelcast-on-karaf-sources</a>. It consist of 3 maven modules:</p><p>instance (it contains a spring dm descriptor which creates the instance).
shell (A shell module which contains a couple of hazelcast commands included the echo).
feature (A feature descriptor for easier installation of the above modules and their deps).
Once you build the project from the karaf shell you can run:</p><figure><img src=images/demo.png alt="Figure 3: Installing and using the command"><figcaption><p>Figure 3: Installing and using the command</p></figcaption></figure><p>Enjoy!</p><p>Note: I am planning to blog more on the subject if I have the time, so stay around.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2019 -
2022
Ioannis Canellos
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><script src=/js/coder.min.236049395dc3682fb2719640872958e12f1f24067bb09c327b233e6290c7edac.js integrity="sha256-I2BJOV3DaC+ycZZAhylY4S8fJAZ7sJwyeyM+YpDH7aw="></script></body></html>